{"ast":null,"code":"var _jsxFileName = \"/Users/raphtalia/workspace/rails/5xruby/client/src/index.js\";\nimport React from 'react';\nimport { render } from 'react-dom';\nimport { Header } from './inc/header';\nimport { Footer } from './inc/footer';\nimport { TodoForm } from './todoForm';\nimport { TodoList } from './todoList';\nimport { Login } from './login';\n\nclass TodoApp extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      userSession: TodoApp.getUserSessionData(),\n      tasks: [],\n      currentTask: ''\n    };\n    this.addTask = this.addTask.bind(this);\n    this.removeTask = this.removeTask.bind(this);\n    this.doneTask = this.doneTask.bind(this);\n    this.doLogin = this.doLogin.bind(this); // this.uri = 'http://127.0.0.1:3000/tasks'\n\n    this.uri = 'https://fivexruby-server.heokuapp.com/tasks';\n  }\n\n  componentWillMount() {\n    this.refreshTasks();\n  }\n\n  refreshTasks() {\n    function handleErrors(response) {\n      if (!response.ok) {\n        throw Error(response.statusText);\n      }\n\n      return response;\n    }\n\n    console.log(this.uri);\n    fetch(this.uri, {\n      method: 'get'\n    }).then(handleErrors).then(response => response.json().then(data => ({\n      data: data,\n      status: response.status\n    }))).then(res => {\n      if (res.data) {\n        this.setState({\n          tasks: res.data\n        });\n      }\n    }).catch(function (err) {\n      alert('Fetch エラー : サーバー死んだ');\n    });\n  }\n\n  static getUserSessionData() {\n    let loginData = localStorage.getItem('login');\n    loginData = JSON.parse(loginData);\n\n    if (loginData !== null && loginData.login === true) {\n      return {\n        userName: loginData.userName\n      };\n    } else {\n      return false;\n    }\n  }\n\n  static isLogged() {\n    let loginData = localStorage.getItem('login');\n    loginData = JSON.parse(loginData);\n\n    if (loginData !== null && loginData.login === true) {\n      return true;\n    }\n\n    return false;\n  }\n\n  doLogin(userName) {\n    let loginData = {\n      login: true,\n      userName: userName\n    };\n    this.setState({\n      userSession: {\n        userName: loginData.userName\n      }\n    });\n    loginData = JSON.stringify(loginData);\n    localStorage.setItem('login', loginData);\n  }\n\n  addTask(task) {\n    // let updatedList = this.state.tasks;\n    // updatedList.push({ text: task, status: 'passive' });\n    // this.setState({ tasks: updatedList });\n    // this.updateLocalStorage(updatedList);\n    if (task !== '') {\n      fetch(this.uri, {\n        method: 'post',\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Accept: \"application/json\"\n        },\n        body: JSON.stringify({\n          text: task,\n          status: 'onhand'\n        })\n      }).then(this.setState({\n        tasks: []\n      }), setTimeout(() => {\n        this.refreshTasks();\n      }, 1000));\n    } else {\n      alert('何もない');\n    } // .then(\n    //     response =>\n    //         response.json().then(data => ({\n    //             data: data,\n    //             status: response.status\n    //         }))\n    // )\n    // .then(res => {\n    //     if (res.data) {\n    //         this.setState({\n    //             tasks: res.data\n    //         });\n    //     }\n    // })\n\n  }\n\n  removeTask(task_id) {\n    // let updatedList = this.state.tasks;\n    // updatedList.splice(task_id.replace('task_', ''), 1);\n    // this.setState({ tasks: updatedList });\n    // this.updateLocalStorage(updatedList);\n    fetch(this.uri + task_id, {\n      method: 'delete',\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\"\n      }\n    }).then(this.setState({\n      tasks: []\n    }), setTimeout(() => {\n      this.refreshTasks();\n    }, 100));\n  }\n\n  doneTask(task_id) {\n    // let updatedList = this.state.tasks;\n    // let currentStatus = updatedList[task_id.replace('task_', '')].status;\n    // let newStatus = 'active';\n    // if (currentStatus === 'active') {\n    //     newStatus = 'passive';\n    // }\n    // updatedList[task_id.replace('task_', '')].status = newStatus;\n    // this.setState({ tasks: updatedList });\n    // this.updateLocalStorage(updatedList);\n    function handleErrors(response) {\n      if (!response.ok) {\n        throw Error(response.statusText);\n      }\n\n      return response;\n    }\n\n    fetch(this.uri + task_id, {\n      method: 'get'\n    }).then(handleErrors).then(response => response.json().then(data => ({\n      data: data,\n      status: response.status\n    }))).then(res => {\n      if (res.data) {\n        delete res.data.id;\n        this.setState({\n          currentTask: res.data\n        });\n      }\n    }).then(setTimeout(() => {\n      var data = this.state.currentTask;\n      data.status == 'passive' ? data.status = 'active' : data.status = 'passive';\n      fetch(this.uri + task_id, {\n        method: 'put',\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Accept: \"application/json\"\n        },\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Accept: \"application/json\"\n        },\n        body: JSON.stringify(data)\n      });\n    }, 100)).then(this.setState({\n      tasks: []\n    }), setTimeout(() => {\n      this.refreshTasks();\n    }, 200)).catch(function (err) {\n      console.log(err);\n      alert('Fetch エラー : サーバー死んだ');\n    });\n  } // updateLocalStorage(updatedList) {\n  //     var updatedList = JSON.stringify(updatedList);\n  //     localStorage.setItem('tasks', updatedList);\n  //     return true;\n  // }\n\n\n  render() {\n    let layout = React.createElement(Login, {\n      doLogin: this.doLogin,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    });\n\n    if (TodoApp.isLogged() === true) {\n      layout = React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248\n        },\n        __self: this\n      }, React.createElement(Header, {\n        loginData: TodoApp.getUserSessionData,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249\n        },\n        __self: this\n      }), React.createElement(TodoForm, {\n        addTask: this.addTask,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }), React.createElement(TodoList, {\n        myList: this.state.tasks,\n        addTask: this.addTask,\n        removeTask: this.removeTask,\n        doneTask: this.doneTask,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251\n        },\n        __self: this\n      }), React.createElement(Footer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253\n        },\n        __self: this\n      }));\n    }\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }, layout));\n  }\n\n}\n\nrender(React.createElement(TodoApp, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 267\n  },\n  __self: this\n}), document.getElementById('appRoot'));","map":{"version":3,"sources":["/Users/raphtalia/workspace/rails/5xruby/client/src/index.js"],"names":["React","render","Header","Footer","TodoForm","TodoList","Login","TodoApp","Component","constructor","state","userSession","getUserSessionData","tasks","currentTask","addTask","bind","removeTask","doneTask","doLogin","uri","componentWillMount","refreshTasks","handleErrors","response","ok","Error","statusText","console","log","fetch","method","then","json","data","status","res","setState","catch","err","alert","loginData","localStorage","getItem","JSON","parse","login","userName","isLogged","stringify","setItem","task","headers","Accept","body","text","setTimeout","task_id","id","layout","document","getElementById"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { render } from 'react-dom';\n\nimport { Header } from './inc/header';\nimport { Footer } from './inc/footer';\nimport { TodoForm } from './todoForm';\nimport { TodoList } from './todoList';\nimport { Login } from './login';\n\nclass TodoApp extends React.Component {\n\n    constructor() {\n        super();\n\n        this.state = {\n            userSession: TodoApp.getUserSessionData(),\n            tasks: [],\n            currentTask: ''\n        };\n        this.addTask = this.addTask.bind(this);\n        this.removeTask = this.removeTask.bind(this);\n        this.doneTask = this.doneTask.bind(this);\n        this.doLogin = this.doLogin.bind(this);\n        // this.uri = 'http://127.0.0.1:3000/tasks'\n        this.uri = 'https://fivexruby-server.heokuapp.com/tasks';\n    }\n\n    componentWillMount() {\n        this.refreshTasks()\n    }\n\n    refreshTasks() {\n        function handleErrors(response) {\n            if (!response.ok) {\n                throw Error(response.statusText);\n            }\n            return response;\n        }\n        console.log(this.uri)\n        fetch(this.uri, {\n            method: 'get'\n        })\n            .then(handleErrors)\n            .then(\n                response =>\n                    response.json().then(data => ({\n                        data: data,\n                        status: response.status\n                    }))\n            )\n            .then(res => {\n                if (res.data) {\n                    this.setState({\n                        tasks: res.data\n                    });\n                }\n            })\n            .catch(function (err) {\n                alert('Fetch エラー : サーバー死んだ');\n            });\n    }\n\n    static getUserSessionData() {\n        let loginData = localStorage.getItem('login');\n        loginData = JSON.parse(loginData);\n        if (loginData !== null && loginData.login === true) {\n            return { userName: loginData.userName };\n        } else {\n            return false;\n        }\n    }\n\n    static isLogged() {\n        let loginData = localStorage.getItem('login');\n        loginData = JSON.parse(loginData);\n        if (loginData !== null && loginData.login === true) {\n            return true;\n        }\n        return false;\n    }\n\n    doLogin(userName) {\n        let loginData = {\n            login: true,\n            userName: userName\n        };\n        this.setState({\n            userSession: {\n                userName: loginData.userName,\n            }\n        });\n        loginData = JSON.stringify(loginData);\n        localStorage.setItem('login', loginData);\n    }\n\n    addTask(task) {\n        // let updatedList = this.state.tasks;\n        // updatedList.push({ text: task, status: 'passive' });\n        // this.setState({ tasks: updatedList });\n        // this.updateLocalStorage(updatedList);\n\n        if (task !== '') {\n            fetch(this.uri, {\n                method: 'post',\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    Accept: \"application/json\",\n                },\n                body: JSON.stringify(\n                    { text: task, status: 'onhand' }\n                )\n            })\n                .then(\n                    this.setState({\n                        tasks: []\n                    }),\n                    setTimeout(() => {\n                        this.refreshTasks()\n                    }, 1000)\n                )\n        } else {\n            alert('何もない')\n        }\n\n        // .then(\n        //     response =>\n        //         response.json().then(data => ({\n        //             data: data,\n        //             status: response.status\n        //         }))\n        // )\n        // .then(res => {\n        //     if (res.data) {\n        //         this.setState({\n        //             tasks: res.data\n        //         });\n        //     }\n        // })\n    }\n\n    removeTask(task_id) {\n        // let updatedList = this.state.tasks;\n        // updatedList.splice(task_id.replace('task_', ''), 1);\n        // this.setState({ tasks: updatedList });\n        // this.updateLocalStorage(updatedList);\n\n        fetch(this.uri + task_id, {\n            method: 'delete',\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Accept: \"application/json\",\n            }\n        })\n            .then(\n                this.setState({\n                    tasks: []\n                }),\n                setTimeout(() => {\n                    this.refreshTasks()\n                }, 100)\n            )\n    }\n\n    doneTask(task_id) {\n        // let updatedList = this.state.tasks;\n        // let currentStatus = updatedList[task_id.replace('task_', '')].status;\n        // let newStatus = 'active';\n        // if (currentStatus === 'active') {\n        //     newStatus = 'passive';\n        // }\n        // updatedList[task_id.replace('task_', '')].status = newStatus;\n        // this.setState({ tasks: updatedList });\n        // this.updateLocalStorage(updatedList);\n\n        function handleErrors(response) {\n            if (!response.ok) {\n                throw Error(response.statusText);\n            }\n            return response;\n        }\n\n\n        fetch(this.uri + task_id, {\n            method: 'get'\n        })\n            .then(handleErrors)\n            .then(\n                response =>\n                    response.json().then(data => ({\n                        data: data,\n                        status: response.status\n                    }))\n            )\n            .then(res => {\n                if (res.data) {\n                    delete res.data.id\n                    this.setState({\n                        currentTask: res.data\n                    });\n                }\n            })\n            .then(\n                setTimeout(() => {\n                    var data = this.state.currentTask\n\n                    data.status == 'passive' ?\n                        data.status = 'active' : data.status = 'passive'\n                    fetch(this.uri + task_id, {\n                        method: 'put',\n                        headers: {\n                            \"Content-Type\": \"application/json\",\n                            Accept: \"application/json\",\n                        },\n                        headers: {\n                            \"Content-Type\": \"application/json\",\n                            Accept: \"application/json\",\n                        },\n                        body: JSON.stringify(\n                            data\n                        )\n                    })\n                }, 100)\n            )\n            .then(\n                this.setState({\n                    tasks: []\n                }),\n                setTimeout(() => {\n                    this.refreshTasks()\n                }, 200)\n            )\n            .catch(function (err) {\n                console.log(err)\n                alert('Fetch エラー : サーバー死んだ');\n            });\n    }\n\n    // updateLocalStorage(updatedList) {\n    //     var updatedList = JSON.stringify(updatedList);\n    //     localStorage.setItem('tasks', updatedList);\n    //     return true;\n    // }\n\n    render() {\n        let layout = (<Login doLogin={this.doLogin} />);\n        if (TodoApp.isLogged() === true) {\n            layout = (\n                <div>\n                    <Header loginData={TodoApp.getUserSessionData} />\n                    <TodoForm addTask={this.addTask} />\n                    <TodoList myList={this.state.tasks} addTask={this.addTask} removeTask={this.removeTask}\n                        doneTask={this.doneTask} />\n                    <Footer />\n                </div>\n            );\n        }\n        return (\n            <div>\n                <div className=\"content\">\n                    {layout}\n                </div>\n            </div>\n        )\n    }\n}\n\nrender(<TodoApp />, document.getElementById('appRoot'));\n"]},"metadata":{},"sourceType":"module"}